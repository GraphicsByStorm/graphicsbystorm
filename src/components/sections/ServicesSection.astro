---
import { SERVICES, $$fmtRange, $$fmtUSD, PRICING_NOTES } from '$lib/data/services';

const cta = { text: 'Start a project', href: '/#contact' };
const altCta = { text: 'Premade work → Shop', href: '/shop' };
---

<section id="services" class="section bg-[var(--surface-0,#0a0a0a)]">
  <div class="mx-auto max-w-6xl px-4 py-12 sm:py-14 lg:py-16">
    <div class="mb-6 flex items-center justify-between gap-3">
      <h2 class="text-[clamp(1.35rem,2.2vw,1.75rem)] font-extrabold tracking-tight text-white">
        <span class="mr-2 inline-block h-3 w-1.5 translate-y-[2px] rounded-full"
              style="background: var(--color-brand-500,#E2A028);"></span>
        Services & Pricing
      </h2>

      <div class="flex gap-2">
        <a href={cta.href}
           class="inline-flex items-center rounded-md bg-[var(--color-brand-500,#E2A028)] px-3.5 py-2 text-[13px] font-semibold text-black shadow hover:opacity-90">
          {cta.text}
        </a>
        <a href={altCta.href}
           class="inline-flex items-center rounded-md border border-white/10 bg-white/[.05] px-3.5 py-2 text-[13px] font-semibold text-white hover:bg-white/[.1]">
          {altCta.text}
        </a>
      </div>
    </div>

    <div class="grid gap-3 sm:grid-cols-2 lg:grid-cols-3">
      {SERVICES.map((svc) => {
        const startAt = svc.tiers?.[0]?.price?.min ?? svc.typicalRange.min;
        return (
          <article class="svc-card">
            <div class="svc-accent" />
            <h3 class="svc-title">{svc.title}</h3>
            <p class="svc-blurb line-clamp-2">{svc.blurb}</p>

            <div class="mt-1.5 flex items-center gap-2">
              <span class="price-pill">From {$$fmtUSD(startAt)}</span>
              <span class="price-range">Typical: {$$fmtRange(svc.typicalRange)}</span>
            </div>

            {svc.tiers?.length ? (
              <ul class="mt-2 space-y-1.5">
                {svc.tiers.slice(0, 2).map((t) => (
                  <li class="tier">
                    <div class="tier-head">
                      <span class="tier-name">{t.name}</span>
                      <span class="tier-price">{$$fmtRange(t.price)}</span>
                    </div>
                    <div class="tier-meta">~ {t.timeline}</div>
                  </li>
                ))}
              </ul>
            ) : null}

            <a href={`${cta.href}?service=${encodeURIComponent(svc.title)}`} class="svc-cta">
              Get a precise quote →
            </a>
          </article>
        );
      })}
    </div>

    <ul class="mt-5 list-disc space-y-1 pl-5 text-xs text-neutral-400">
      {PRICING_NOTES.map((n) => <li>{n}</li>)}
    </ul>
  </div>
</section>

<style>
  .svc-card {
    position: relative;
    border-radius: 14px;
    border: 1px solid rgba(255,255,255,.08);
    background: rgba(255,255,255,.04);
    padding: .8rem .75rem .85rem;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    display: flex;
    flex-direction: column;
    gap: .3rem;
  }
  .svc-card:hover {
    transform: translateY(-1px);
    background: rgba(255,255,255,.055);
    box-shadow: 0 8px 20px rgba(0,0,0,.32);
  }
  .svc-accent {
    position: absolute;
    inset-inline: 0;
    top: 0;
    height: 3px;
    border-top-left-radius: 14px;
    border-top-right-radius: 14px;
    background: linear-gradient(90deg,
      color-mix(in oklab, var(--color-brand-500,#E2A028) 92%, #fff 8%),
      var(--color-brand-500,#E2A028));
  }
  .svc-title {
    color: #fff;
    font-weight: 900;
    letter-spacing: .2px;
    font-size: .98rem;
    margin-top: .3rem;
  }
  .svc-blurb {
    color: rgba(230,230,230,.9);
    font-size: .9rem;
    line-height: 1.45;
    margin-top: .1rem;
  }

  .price-pill {
    display: inline-flex;
    align-items: center;
    gap: .35rem;
    padding: .2rem .45rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,.1);
    background: color-mix(in oklab, var(--color-brand-500,#E2A028) 14%, transparent);
    color: #fff;
    font-weight: 800;
    font-size: .8rem;
  }
  .price-range {
    color: #b9bec5;
    font-size: .78rem;
  }

  .tier {
    padding: .4rem .5rem;
    border: 1px solid rgba(255,255,255,.08);
    border-radius: 10px;
    background: rgba(255,255,255,.03);
  }
  .tier-head { display: flex; justify-content: space-between; gap: .5rem; align-items: baseline; }
  .tier-name { color: #fff; font-weight: 800; font-size: .88rem; }
  .tier-price { color: #dfe3e7; font-weight: 700; font-size: .86rem; }
  .tier-meta { color: #9aa0a6; font-size: .76rem; margin-top: .1rem; }

  .svc-cta {
    margin-top: auto;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    border-radius: 9px;
    border: 1px solid rgba(255,255,255,.1);
    background: rgba(255,255,255,.04);
    color: #fff;
    font-weight: 700;
    font-size: .88rem;
    padding: .45rem .6rem;
    transition: background .12s ease, transform .08s ease;
  }
  .svc-cta:hover { background: rgba(255,255,255,.08); transform: translateY(-1px); }

  /* Simple line clamp without plugin */
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;           /* vendor */
    line-clamp: 2;                   /* standard */
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
