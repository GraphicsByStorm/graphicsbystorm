---
import BaseLayout from '$layouts/BaseLayout.astro';
import ExampleWork from '$svelte/ExampleWork.svelte';
import ExampleSectionTitle from '$svelte/ExampleSectionTitle.svelte'
import { WORKS } from '$lib/data/work';
import { WORK_META } from '$lib/data/workMeta';

type Details = { tools?: string; design?: string; creativity?: string; critique?: string; directions?: string; craftsmanship?: string; };
type WorkItem = typeof WORKS[number];
type WorkItemWithDetails = WorkItem & { details?: Details };

const items: WorkItemWithDetails[] = WORKS.map((w) => {
  const meta = (WORK_META as Record<string, { details?: Details }>)[w.slug] ?? {};
  return { ...w, details: meta.details };
});

// Astro + Svelte runes prop inference workaround
const workProps: any = { items };

export const prerender = true;
---

<BaseLayout title="Work â€¢ GraphicsByStorm" description="Selected work and case studies">
  <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <ExampleSectionTitle />
  </main>
  <section class="my-[-5rem]">
    <ExampleWork {...workProps} client:visible />
  </section>
</BaseLayout>
